<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galaxy Attack</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c0c2e, #1a1a4a);
            color: white;
            overflow: hidden;
            direction: rtl;
        }

        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c0c2e, #1a1a4a);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-content {
            text-align: center;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #4fc3f7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c0c2e, #1a1a4a);
        }

        .screen.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .screen-content {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .menu-btn {
            padding: 15px 30px;
            font-size: 1.2em;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 10px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-btn:hover {
            transform: translateY(-2px);
            background: #1976d2;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loading-content">
            <div class="loader"></div>
            <h2>🚀 جاري تحميل Galaxy Attack...</h2>
            <p>إعداد الفضاء للقتال</p>
        </div>
    </div>

    <!-- Start Screen -->
    <div id="startScreen" class="screen">
        <div class="screen-content">
            <h1>🌌 Galaxy Attack</h1>
            <div style="margin: 30px 0;">
                <button class="menu-btn" onclick="showScreen('levelSelectScreen')">🎮 بدء اللعبة</button>
                <button class="menu-btn" onclick="showScreen('shipsScreen')">🚀 الأسطول</button>
                <button class="menu-btn" onclick="showScreen('upgradesScreen')">⚡ الترقيات</button>
            </div>
            <div>
                <p>💰 العملات: <span id="coins">1000</span></p>
                <p>💎 الأحجار: <span id="gems">50</span></p>
            </div>
        </div>
    </div>

    <!-- Level Select Screen -->
    <div id="levelSelectScreen" class="screen">
        <div class="screen-content">
            <h2>🎯 اختر المستوى</h2>
            <div id="levelGrid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0;">
                <!-- المستويات سيتم إنشاؤها بالجافاسكريبت -->
            </div>
            <button class="menu-btn" onclick="showScreen('startScreen')">← العودة</button>
        </div>
    </div>

    <!-- Ships Screen -->
    <div id="shipsScreen" class="screen">
        <div class="screen-content">
            <h2>🚀 الأسطول الفضائي</h2>
            <div id="shipsContainer" style="margin: 20px 0;">
                <!-- السفن سيتم إنشاؤها بالجافاسكريبت -->
            </div>
            <button class="menu-btn" onclick="showScreen('startScreen')">← العودة</button>
        </div>
    </div>

    <!-- Upgrades Screen -->
    <div id="upgradesScreen" class="screen">
        <div class="screen-content">
            <h2>⚡ مركز الترقيات</h2>
            <div id="upgradesContainer" style="margin: 20px 0;">
                <!-- الترقيات سيتم إنشاؤها بالجافاسكريبت -->
            </div>
            <button class="menu-btn" onclick="showScreen('startScreen')">← العودة</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen">
        <canvas id="gameCanvas" style="position: absolute; top:0; left:0; width:100%; height:100%;"></canvas>
        <div style="position: absolute; top:20px; left:20px; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 10px;">
            <p>المستوى: <span id="currentLevel">1</span></p>
            <p>النقاط: <span id="currentScore">0</span></p>
        </div>
        <button class="menu-btn" onclick="showScreen('startScreen')" style="position: absolute; bottom:20px; right:20px;">🏠 خروج</button>
    </div>

    <script>
        // ===== الكود الأساسي المبسط =====
        console.log('🌌 بدء تحميل Galaxy Attack...');

        // بيانات اللعبة
        let gameData = {
            coins: 1000,
            gems: 50,
            currentLevel: 1,
            unlockedLevels: 1,
            selectedShip: 'basic',
            upgrades: {
                weapon: 1,
                shield: 1
            }
        };

        // دالة إظهار الشاشات
        function showScreen(screenName) {
            console.log('🔄 الانتقال إلى:', screenName);
            
            // إخفاء جميع الشاشات
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // إظهار الشاشة المطلوبة
            const targetScreen = document.getElementById(screenName);
            if (targetScreen) {
                targetScreen.classList.add('active');
                
                // تحديث محتوى الشاشة إذا لزم الأمر
                updateScreenContent(screenName);
            }
        }

        // تحديث محتوى الشاشات
        function updateScreenContent(screenName) {
            switch(screenName) {
                case 'levelSelectScreen':
                    generateLevels();
                    break;
                case 'shipsScreen':
                    generateShips();
                    break;
                case 'upgradesScreen':
                    generateUpgrades();
                    break;
            }
            
            // تحديث العملات دائماً
            document.getElementById('coins').textContent = gameData.coins;
            document.getElementById('gems').textContent = gameData.gems;
        }

        // إنشاء المستويات
        function generateLevels() {
            const levelGrid = document.getElementById('levelGrid');
            levelGrid.innerHTML = '';
            
            for (let i = 1; i <= 20; i++) {
                const levelBtn = document.createElement('button');
                levelBtn.className = 'menu-btn';
                levelBtn.textContent = i;
                levelBtn.style.width = '60px';
                levelBtn.style.height = '60px';
                
                if (i > gameData.unlockedLevels) {
                    levelBtn.disabled = true;
                    levelBtn.textContent = '🔒';
                    levelBtn.style.background = '#666';
                } else {
                    levelBtn.onclick = () => startLevel(i);
                }
                
                levelGrid.appendChild(levelBtn);
            }
        }

        // إنشاء السفن
        function generateShips() {
            const shipsContainer = document.getElementById('shipsContainer');
            shipsContainer.innerHTML = '';
            
            const ships = [
                { id: 'basic', name: 'الطائرة الأساسية', price: 0, unlocked: true },
                { id: 'fighter', name: 'المقاتلة السريعة', price: 500, unlocked: false },
                { id: 'tank', name: 'الدبابة الفضائية', price: 800, unlocked: false }
            ];
            
            ships.forEach(ship => {
                const shipDiv = document.createElement('div');
                shipDiv.style.background = 'rgba(255,255,255,0.1)';
                shipDiv.style.padding = '15px';
                shipDiv.style.margin = '10px';
                shipDiv.style.borderRadius = '10px';
                shipDiv.style.border = gameData.selectedShip === ship.id ? '2px solid #4fc3f7' : 'none';
                
                shipDiv.innerHTML = `
                    <h3>🚀 ${ship.name}</h3>
                    <p>${ship.unlocked ? 'مفتوحة' : 'سعر: ' + ship.price + ' 💰'}</p>
                    ${ship.unlocked ? 
                        `<button class="menu-btn" onclick="selectShip('${ship.id}')" ${gameData.selectedShip === ship.id ? 'disabled' : ''}>
                            ${gameData.selectedShip === ship.id ? 'محددة' : 'اختيار'}
                        </button>` :
                        `<button class="menu-btn" onclick="buyShip('${ship.id}')" ${gameData.coins >= ship.price ? '' : 'disabled'}>
                            شراء
                        </button>`
                    }
                `;
                
                shipsContainer.appendChild(shipDiv);
            });
        }

        // إنشاء الترقيات
        function generateUpgrades() {
            const upgradesContainer = document.getElementById('upgradesContainer');
            upgradesContainer.innerHTML = '';
            
            const upgrades = [
                { id: 'weapon', name: 'قوة السلاح', level: gameData.upgrades.weapon, price: 50 },
                { id: 'shield', name: 'الدرع', level: gameData.upgrades.shield, price: 75 }
            ];
            
            upgrades.forEach(upgrade => {
                const upgradeDiv = document.createElement('div');
                upgradeDiv.style.background = 'rgba(255,255,255,0.1)';
                upgradeDiv.style.padding = '15px';
                upgradeDiv.style.margin = '10px';
                upgradeDiv.style.borderRadius = '10px';
                
                upgradeDiv.innerHTML = `
                    <h3>${upgrade.name}</h3>
                    <p>المستوى: ${upgrade.level}</p>
                    <p>السعر: ${upgrade.price} 💰</p>
                    <button class="menu-btn" onclick="buyUpgrade('${upgrade.id}')" ${gameData.coins >= upgrade.price ? '' : 'disabled'}>
                        ترقية
                    </button>
                `;
                
                upgradesContainer.appendChild(upgradeDiv);
            });
        }

        // دوال اللعبة
        function selectShip(shipId) {
            gameData.selectedShip = shipId;
            generateShips();
            alert('✓ تم اختيار الطائرة بنجاح!');
        }

        function buyShip(shipId) {
            const ship = { id: 'fighter', price: 500 }; // مبسط للتوضيح
            if (gameData.coins >= ship.price) {
                gameData.coins -= ship.price;
                // في الواقع، يجب فتح السفينة
                alert('✓ تم شراء الطائرة بنجاح!');
                generateShips();
                updateScreenContent('shipsScreen');
            }
        }

        function buyUpgrade(upgradeId) {
            const upgrade = { price: 50 }; // مبسط للتوضيح
            if (gameData.coins >= upgrade.price) {
                gameData.coins -= upgrade.price;
                gameData.upgrades[upgradeId]++;
                alert('✓ تمت الترقية بنجاح!');
                generateUpgrades();
                updateScreenContent('upgradesScreen');
            }
        }

        function startLevel(level) {
            gameData.currentLevel = level;
            showScreen('gameScreen');
            startGame();
        }

        function startGame() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            // ضبط حجم الكانفاس
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // لاعب
            const player = {
                x: canvas.width / 2 - 25,
                y: canvas.height - 100,
                width: 50,
                height: 50,
                color: '#4fc3f7'
            };
            
            // التحكم
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') player.x = Math.max(0, player.x - 10);
                if (e.key === 'ArrowRight') player.x = Math.min(canvas.width - player.width, player.x + 10);
            });
            
            // اللعبة الأساسية
            function gameLoop() {
                // مسح الشاشة
                ctx.fillStyle = 'rgba(12, 12, 46, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // رسم النجوم
                ctx.fillStyle = '#ffffff';
                for (let i = 0; i < 50; i++) {
                    ctx.fillRect(Math.random() * canvas.width, Math.random() * canvas.height, 2, 2);
                }
                
                // رسم اللاعب
                ctx.fillStyle = player.color;
                ctx.fillRect(player.x, player.y, player.width, player.height);
                
                // استمرار اللعبة
                requestAnimationFrame(gameLoop);
            }
            
            gameLoop();
            
            // تحديث واجهة اللعبة
            document.getElementById('currentLevel').textContent = gameData.currentLevel;
        }

        // ===== بدء اللعبة =====
        window.addEventListener('load', function() {
            console.log('✅ تم تحميل الصفحة بالكامل');
            
            // إخفاء شاشة التحميل بعد ثانيتين (ضماناً)
            setTimeout(() => {
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // إظهار شاشة البداية
                showScreen('startScreen');
                
                console.log('🎮 اللعبة جاهزة!');
            }, 1000);
        });

        // حل احتياطي: إخفاء شاشة التحميل إذا حدث أي خطأ
        window.addEventListener('error', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen) {
                loadingScreen.style.display = 'none';
            }
            showScreen('startScreen');
        });

        // إخفاء شاشة التحميل عند الضغط على أي مفتاح (للتطوير)
        document.addEventListener('keydown', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen && loadingScreen.style.display !== 'none') {
                loadingScreen.style.display = 'none';
                showScreen('startScreen');
            }
        });
    </script>
</body>
</html>
